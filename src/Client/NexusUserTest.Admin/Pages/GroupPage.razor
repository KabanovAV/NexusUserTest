@page "/admin/group"
@layout AdminLayout
@rendermode InteractiveServer

<PageTitle>Группы</PageTitle>

<LoadDataView TItem="List<GroupEditDTO>" Data="ApiResponse" />

@if (ApiResponse != null && ApiResponse.Success)
{
    <NexusTableGrid @ref="NexusTable" TItem="GroupEditDTO" Data="ApiResponse.Data" SelectionMode="SelectMode"
                    EditMode="EditMode" AllowSorting="true" AllowFiltering="true"
                    ShowEmptyMessage="true" EmptyMessage="Нет групп">
        <ToolTemplate>
            <NexusGroupButton>
                <NexusButton Title="Добавить" OnClick="Insert" CssClass="btn-primary" IconClass="bi bi-plus-lg" Disable="IsCrud" />
                <NexusButton Title="Изменить" OnClick="Edit" CssClass="btn-warning" IconClass="bi bi-pencil-fill" Disable="IsSelected" />
                <NexusButton Title="Удалить" OnClick="Delete" CssClass="btn-danger" IconClass="bi bi-trash3-fill" Disable="IsSelected" />
            </NexusGroupButton>
            <NexusGroupButton Visible="IsSaveCancel">
                <NexusButton Title="Сохранить" OnClick="Save" CssClass="btn-success" IconClass="bi bi-floppy-fill" Disable="IsSaveCancel" />
                <NexusButton Title="Отменить" OnClick="Cancel" CssClass="btn-danger" IconClass="bi bi-x-lg" Disable="IsSaveCancel" />
            </NexusGroupButton>
        </ToolTemplate>
        <Columns>
            <NexusTableGridColumn Title="#">
                <CellTemplate>
                    @(ApiResponse.Data!.IndexOf(context) + 1)
                </CellTemplate>
            </NexusTableGridColumn>
            <NexusTableGridColumn Title="Название" Property="g => g.Title" Sortable="true" Filterable="true">
                <EditTemplate>
                    <input class="form-control border border-black" type="text" @bind="context.Title" />
                </EditTemplate>
            </NexusTableGridColumn>
            <NexusTableGridColumn Title="Специализация" Property="g => g.SpecializationTitle" Sortable="true" Filterable="true">
                <EditTemplate>
                    <select class="form-select border border-black" @bind="context.SpecializationId">
                        @foreach (var item in SpecializationSelects!)
                        {
                            <option value="@item.Value">@item.Text</option>
                        }
                    </select>
                </EditTemplate>
            </NexusTableGridColumn>
            <NexusTableGridColumn Title="Начало" Property="g => g.Begin" Sortable="true" Filterable="true" >
                <EditTemplate>
                    <input type="datetime-local" class="form-control border border-black" @bind="context.Begin" />
                </EditTemplate>
            </NexusTableGridColumn>
            <NexusTableGridColumn Title="Окончание" Property="g => g.End" Sortable="true" Filterable="true" >
                <EditTemplate>
                    <input type="datetime-local" class="form-control border border-black" @bind="context.End" />
                </EditTemplate>
            </NexusTableGridColumn>
        </Columns>
    </NexusTableGrid>
}
