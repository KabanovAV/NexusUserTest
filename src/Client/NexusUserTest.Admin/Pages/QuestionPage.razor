@page "/admin/question"
@layout AdminLayout
@rendermode InteractiveServer

<PageTitle>Вопросы</PageTitle>

@if (Items == null)
{
    <div class="" style=@($"height: 100%; width:100%; display: flex; align-items: center; justify-content: center;")>
        <div style="">
            <Wave Color="blue" Center="true" Size="2rem" style="opacity:1" />
            <h5 class="mt-3" style="color:blue">
                Загрузка данных
            </h5>
        </div>
    </div>
}
else
{
    <div style="display:@(IsUpsertForm ? "none" : "");">
        <NexusTableGrid @ref="NexusTable" TItem="QuestionDTO" Data="Items" SelectionMode="SelectMode"
                        ExpandMode="NexusTableGridExpandMode.Single" EditMode="EditMode"
                        AllowFiltering="true" ShowEmptyMessage="true" EmptyMessage="Нет вопросов">
            <ToolTemplate>
                <NexusGroupButton>
                    <NexusButton Title="Добавить" OnClick="Insert" CssClass="btn-primary" IconClass="bi bi-plus-lg" Disable="IsCrud" />
                    <NexusButton Title="Изменить" OnClick="Edit" CssClass="btn-warning" IconClass="bi bi-pencil-fill" Disable="IsSelected" />
                    <NexusButton Title="Удалить" OnClick="Delete" CssClass="btn-danger" IconClass="bi bi-trash3-fill" Disable="IsSelected" />
                </NexusGroupButton>
            </ToolTemplate>
            <Columns>
                <NexusTableGridColumn Title="#">
                    <CellTemplate>
                        @(Items.IndexOf(context) + 1)
                    </CellTemplate>
                </NexusTableGridColumn>
                <NexusTableGridColumn Title="Название" Property="q => q.Title" Filterable="true" />
            </Columns>
            <ExpandRow>
                <AnswerView Items="@context.AnswerItems" QuestionId="@context.Id" />
            </ExpandRow>
        </NexusTableGrid>
    </div>
    <div class="h-100" style="display:@(IsUpsertForm ? "" : "none");">
        <QuestionFormPage Data="Data" OnCancel="Cancel" OnSave="Save" TopicSelects="TopicSelects" />
    </div>
}
